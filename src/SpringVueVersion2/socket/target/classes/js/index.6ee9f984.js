(function(e){function t(t){for(var a,o,n=t[0],l=t[1],c=t[2],d=0,p=[];d<n.length;d++)o=n[d],Object.prototype.hasOwnProperty.call(r,o)&&r[o]&&p.push(r[o][0]),r[o]=0;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(e[a]=l[a]);u&&u(t);while(p.length)p.shift()();return i.push.apply(i,c||[]),s()}function s(){for(var e,t=0;t<i.length;t++){for(var s=i[t],a=!0,n=1;n<s.length;n++){var l=s[n];0!==r[l]&&(a=!1)}a&&(i.splice(t--,1),e=o(o.s=s[0]))}return e}var a={},r={index:0},i=[];function o(t){if(a[t])return a[t].exports;var s=a[t]={i:t,l:!1,exports:{}};return e[t].call(s.exports,s,s.exports,o),s.l=!0,s.exports}o.m=e,o.c=a,o.d=function(e,t,s){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(o.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)o.d(s,a,function(t){return e[t]}.bind(null,a));return s},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/";var n=window["webpackJsonp"]=window["webpackJsonp"]||[],l=n.push.bind(n);n.push=t,n=n.slice();for(var c=0;c<n.length;c++)t(n[c]);var u=l;i.push([0,"chunk-vendors"]),s()})({0:function(e,t,s){e.exports=s("56d7")},"034f":function(e,t,s){"use strict";s("85ec")},"0516":function(e,t,s){"use strict";s("e943")},2153:function(e,t,s){"use strict";s("27cf")},2583:function(e,t,s){},"27cf":function(e,t,s){},"3fd0":function(e,t,s){},4547:function(e,t,s){"use strict";s("f0ee")},4899:function(e,t,s){"use strict";s("b1ab")},"56d7":function(e,t,s){"use strict";s.r(t);s("e260"),s("e6cf"),s("cca6"),s("a79d");var a=s("2b0e"),r=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("keep-alive",[s("router-view")],1)],1)},i=[],o=s("5530"),n=(s("ac1f"),s("5319"),s("2f62")),l={name:"App",data:function(){return{}},methods:Object(o["a"])(Object(o["a"])({},Object(n["b"])("group",["initHost","destroyHost"])),{},{toGroup:function(){var e=this;if(localStorage.getItem("login")){var t=JSON.parse(localStorage.getItem("host"));this.$axios.get("http://localhost:8080/login",{params:{userID:t.userID,password:t.password}}).then((function(t){t.data&&t.data.userID?"0"===t.data.userID?(alert("已登录，请勿重复登录"),e.$router.replace({name:"login"})):(e.initHost(t.data),e.$router.replace({name:"group"})):(localStorage.clear(),alert("验证过期,请重新登录"),e.$router.replace({name:"login"}))})).catch((function(t){alert("网络异常\n"+t.message),localStorage.clear(),e.$router.replace({name:"login"})}))}else this.$router.replace({name:"login"})}}),computed:Object(o["a"])({},Object(n["e"])("group",["host"])),mounted:function(){var e=this;console.log("mounted"),window.onbeforeunload=function(){console.log("before"),e.host.userID&&e.$axios.get("http://localhost:8080/offLine",{params:{userID:e.host.userID}}),e.$store.dispatch("group/disconnect"),e.destroyHost()},this.toGroup()}},c=l,u=(s("034f"),s("2877")),d=Object(u["a"])(c,r,i,!1,null,null,null),p=d.exports,h=(s("e9c4"),s("4de4"),s("d3b7"),s("99af"),{namespaced:!0,actions:{initRoom:function(e,t){e.commit("INITROOM",t)},initHost:function(e,t){e.commit("INITHOST",t)},initUsers:function(e,t){e.commit("INITUSERS",t)},initGroups:function(e,t){e.commit("INITGROUPS",t)},updateSelected:function(e,t){e.commit("UPDATESELECTED",t)},connect:function(e){if(window.WebSocket){var t={};t=new WebSocket("ws://localhost/ws"),t.onopen=function(){t.send(JSON.stringify({type:"/simple/welcome",text:'{"userName": "'+e.getters.fullName+'"}'}))},t.onclose=function(e){},t.onmessage=function(s){var a=JSON.parse(s.data),r=a.type;if("/simple/greeting"===r)e.commit("updateMsgList",a.text);else if("/simple/welcome"===r){if(a.text.userName===e.getters.fullName)return;e.commit("updateAliveUsers",a.text.userName),e.commit("updateMsgList",{userName:a.text.userName+"上线了@",content:""}),t.send(JSON.stringify({type:"/simple/youAreWelcome",text:'{"userName": "'+e.getters.fullName+'"}'}))}else if("/simple/exit"===r){var i=e.getters.totalUsers[e.state.selected];-1!==e.state.agreeUsers.indexOf(a.text.userName)&&(e.commit("updateRecordUsers",a.text.userName),e.commit("updateAgreeUsers",e.state.agreeUsers.filter((function(e){return e!==a.text.userName})))),i===a.text.userName?e.commit("UPDATESELECTED",e.state.agreeUsers.length-1):e.commit("UPDATESELECTED",e.getters.totalUsers.indexOf(i)),e.commit("updateAliveUsers",e.state.aliveUsers.filter((function(e){return e!==a.text.userName}))),e.commit("updateApplyUsers",e.state.applyUsers.filter((function(e){return e!==a.text.userName}))),e.commit("updateMsgList",{userName:a.text.userName+"下线了@",content:""})}else if("/simple/youAreWelcome"===r){if(a.text.userName===e.getters.fullName)return;if(-1!==e.state.aliveUsers.indexOf(a.text.userName))return;e.commit("updateAliveUsers",a.text.userName)}else if(r==="/user/"+e.getters.fullName+"/simple/applyConnect"){if(-1!==e.state.applyUsers.indexOf(a.text.sourceUserName))return;e.commit("updateApplyUsers",a.text.sourceUserName)}else if(r==="/user/"+e.getters.fullName+"/simple/agreeConnect")e.commit("updateRecordUsers",e.state.recordUsers.filter((function(e){return e!==a.text.sourceUserName}))),e.commit("updateApplyUsers",e.state.applyUsers.filter((function(e){return e!==a.text.sourceUserName}))),e.commit("updateAgreeUsers",a.text.sourceUserName);else if(r==="/user/"+e.getters.fullName+"/simple/sendMessageToUser"){if(e.commit("updatePrivateMsg",a.text),a.text.sourceName===e.state.agreeUsers[e.state.selected])return;if(-1!==e.state.newMsgUsers.indexOf(a.text.sourceName))return;e.commit("updateNewMsgUsers",a.text.sourceName)}},e.commit("updateSocket",t)}else alert("该浏览器不支持WebSocket,请更换浏览器重新打开网址")},disconnect:function(e){null!==e.state.socket&&e.state.socket.send&&(e.state.socket.send(JSON.stringify({type:"/simple/exit",text:'{"userName": "'+e.getters.fullName+'"}'})),e.state.socket.close(),e.state.socket={})},destroyHost:function(e){e.commit("DESTROYHOST")},destroyData:function(e){e.commit("DESTROYDATA")},destroyMsg:function(e){e.commit("DESTROYMSG")},sendPrivate:function(e,t){e.state.socket.send(JSON.stringify(t)),e.commit("updatePrivateMsg",JSON.parse(t.text))},sendPublic:function(e,t){e.state.socket.send(JSON.stringify(t))},sendApply:function(e,t){e.state.socket.send(JSON.stringify(t))},sendAgree:function(e,t){e.state.socket.send(JSON.stringify(t));var s=JSON.parse(t.text).targetUserName;e.commit("deleteApplyUsers",s),e.commit("updateAgreeUsers",s),e.commit("updateRecordUsers",e.state.recordUsers.filter((function(e){return e!==s})))}},mutations:{DESTROYHOST:function(e){e.host={}},DESTROYDATA:function(e){e.aliveUsers=[],e.applyUsers=[],e.agreeUsers=[],e.recordUsers=[],e.totalUsers=[],e.newMsgUsers=[],e.selected=0},DESTROYMSG:function(e){e.msgList=[],e.room={},e.privateMsg={}},UPDATESELECTED:function(e,t){e.selected=t},INITROOM:function(e,t){e.room=t},INITUSERS:function(e,t){e.users=t},INITHOST:function(e,t){e.host=t},INITGROUPS:function(e,t){e.groups=t},updateHeadImage:function(e,t){e.host.headImageAddress=t},updateUserName:function(e,t){e.host.userName=t},updateDetail:function(e,t){console.log("前update"),console.log(t),e.host.detail.sex=t.sex,e.host.detail.age=t.age,e.host.detail.birthday=t.birthday,e.host.detail.location=t.location,e.host.detail.persionalSign=t.persionalSign,console.log("后update")},updateSocket:function(e,t){e.socket=t},updateMsgList:function(e,t){t.userName=t.userName.substring(0,t.userName.lastIndexOf("@")),e.msgList.push(t)},updateAliveUsers:function(e,t){t instanceof Array?e.aliveUsers=t:e.aliveUsers.push(t)},updateApplyUsers:function(e,t){t instanceof Array?e.applyUsers=t:e.applyUsers.push(t)},deleteApplyUsers:function(e,t){e.applyUsers=e.applyUsers.filter((function(e){return e!==t}))},updateAgreeUsers:function(e,t){t instanceof Array?e.agreeUsers=t:e.agreeUsers.push(t)},updateNewMsgUsers:function(e,t){t instanceof Array?e.newMsgUsers=t:e.newMsgUsers.push(t)},updateRecordUsers:function(e,t){t instanceof Array?e.recordUsers=t:e.recordUsers.push(t)},deleteAgreeUsers:function(e,t){e.agreeUsers=e.agreeUsers.filter((function(e){}))},updatePrivateMsgBefore:function(e,t){t.sourceID!==e.host.userID?e.privateMsg[t.sourceName].unshift(t):e.privateMsg[t.targetName].unshift(t)},updatePrivateMsg:function(e,t){t.sourceID!==e.host.userID?(e.privateMsg[t.sourceName]||a["a"].set(e.privateMsg,t.sourceName,[]),e.privateMsg[t.sourceName].push(t)):(e.privateMsg[t.targetName]||a["a"].set(e.privateMsg,t.targetName,[]),e.privateMsg[t.targetName].push(t))}},state:{host:{},room:{},users:[],groups:[],socket:{},msgList:[],aliveUsers:[],applyUsers:[],agreeUsers:[],recordUsers:[],totalUsers:[],newMsgUsers:[],privateMsg:{},selected:0},getters:{fullName:function(e){return e.host.userName+"@"+e.host.userID},totalUsers:function(e){return e.agreeUsers.concat(e.recordUsers)}}});a["a"].use(n["a"]);var g=new n["a"].Store({modules:{group:h}}),m=s("bc3a"),f=s.n(m),v=s("8c4f"),b=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("form",{attrs:{action:"/login",method:"get",id:"login"}},[s("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.userID,expression:"userID",modifiers:{trim:!0}}],staticClass:"key",attrs:{type:"text",name:"userID",placeholder:" 账号"},domProps:{value:e.userID},on:{input:function(t){t.target.composing||(e.userID=t.target.value.trim())},blur:function(t){return e.$forceUpdate()}}}),s("br"),s("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.password,expression:"password",modifiers:{trim:!0}}],staticClass:"key",attrs:{type:"password",name:"password",placeholder:" 密码"},domProps:{value:e.password},on:{input:function(t){t.target.composing||(e.password=t.target.value.trim())},blur:function(t){return e.$forceUpdate()}}}),s("br"),s("img",{attrs:{id:"verifyCodeImg",src:e.verifyCodeImg},on:{click:e.changeImg}}),s("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.verifyCodeStr,expression:"verifyCodeStr",modifiers:{trim:!0}}],attrs:{id:"verifyCodeStr",type:"text",placeholder:"请输入验证码"},domProps:{value:e.verifyCodeStr},on:{input:function(t){t.target.composing||(e.verifyCodeStr=t.target.value.trim())},blur:function(t){return e.$forceUpdate()}}}),s("br"),s("span",{staticStyle:{color:"red"}},[e._v(e._s(e.error))]),s("transition-group",{attrs:{"enter-active-class":"animate__swing"}},[s("button",{directives:[{name:"show",rawName:"v-show",value:e.isShow,expression:"isShow"}],key:"1",staticClass:"submit",class:{animate__animated:e.isShow},attrs:{type:"button"},on:{click:e.login}},[e._v(" 登录 ")]),s("button",{directives:[{name:"show",rawName:"v-show",value:!e.isShow,expression:"!isShow"}],key:"2",staticClass:"submit",class:{animate__animated:!e.isShow},attrs:{type:"button"},on:{click:e.register}},[e._v(" 注册 ")])]),s("a",{directives:[{name:"show",rawName:"v-show",value:e.isShow,expression:"isShow"}],staticClass:"tip",attrs:{href:"http://www.baidu.com"},on:{click:function(t){t.preventDefault(),e.isShow=!e.isShow}}},[e._v("没有账号?注册一个吧")]),s("a",{directives:[{name:"show",rawName:"v-show",value:!e.isShow,expression:"!isShow"}],staticClass:"tip",attrs:{href:"#"},on:{click:function(t){t.preventDefault(),e.isShow=!e.isShow}}},[e._v("已有账号？")])],1)])},y=[],I=(s("1276"),s("77ed"),{name:"Login",data:function(){return{userID:"",password:"",verifyCodeStr:"",verifyCodeImg:"http://localhost:8080/login/verifyCodeImg",error:"",isShow:!0}},methods:Object(o["a"])(Object(o["a"])({},Object(n["b"])("group",["initHost"])),{},{changeImg:function(){this.verifyCodeImg="http://localhost:8080/login/verifyCodeImg?t="+Date.now()},checkComplete:function(){return this.userID&&this.password?!!this.verifyCodeStr||(alert("请输入验证码"),!1):(alert("请输入账号密码"),!1)},login:function(){var e=this;this.checkComplete()&&this.$axios.get("http://localhost:8080/login/verifyCodeStr",{params:{verifyCodeStr:this.verifyCodeStr}}).then((function(t){t.data?e.$axios.get("http://localhost:8080/login",{params:{userID:e.userID,password:e.password}}).then((function(t){if(t.data&&t.data.userID){if("0"===t.data.userID)return void(e.error="该用户已经登录,请勿重复登录");e.initHost(t.data),localStorage.setItem("login","true"),localStorage.setItem("host",JSON.stringify(t.data)),e.$router.replace({name:"group"})}else e.error="输入的密码和账号错误,请重新输入",e.changeImg()})).catch((function(t){e.error="请求发生异常,请检查网络环境"})):(e.error="验证码输入错误,请重新输入",e.changeImg())})).catch((function(t){e.error="请求发生异常，请检查网络环境"}))},register:function(){var e=this;if(this.checkComplete())return this.userID.length<7?(alert("账号必须大于或等于7位"),void this.changeImg()):this.userID.length>15?(alert("账号必须小于或等于15位"),void this.changeImg()):0!==this.userID.split("").filter((function(e){return!(e>="0"&&e<="9")})).length?(alert("账号中含有非数字字符"),void this.changeImg()):this.password.length<6?(alert("密码必须大于或等于6位"),void this.changeImg()):this.password.length>15?(alert("密码必须小于或等于15位"),void this.changeImg()):void this.$axios.get("http://localhost:8080/login/verifyCodeStr",{params:{verifyCodeStr:this.verifyCodeStr}}).then((function(t){t.data?e.$axios.get("http://localhost:8080/register/user",{params:{userID:e.userID,password:e.password}}).then((function(t){if(!0!==t)e.error="输入的账号已注册,请重新输入",e.changeImg();else{e.userID,e.password,e.userID;e.initHost(t.data),localStorage.setItem("login","true"),localStorage.setItem("host",JSON.stringify(t.data)),e.$router.replace({name:"group"})}})).catch((function(t){e.error="请求发生异常,请检查网络环境"})):(e.error="验证码输入错误,请重新输入",e.changeImg())})).catch((function(t){e.error="请求发生异常，请检查网络环境"}))}})}),w=I,x=(s("0516"),Object(u["a"])(w,b,y,!1,null,"3b9c3798",null)),U=x.exports,N=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("div",{staticClass:"head"},[s("img",{attrs:{src:e.host.headImageAddress}}),s("h1",[e._v(e._s(e.host.userName))])]),s("div",{staticClass:"content"},[s("div",{staticClass:"left-menu"},[s("div",{staticClass:"group-menu",on:{click:e.gClick}},[s("div",{staticClass:"menu-head",style:{backgroundColor:e.groupClick?"#FE8333":"#fff"}},[s("img",{staticClass:"menu-head-img-open",style:{display:e.groupClick?"inline-block":"none"},attrs:{src:"image/互动.png"}}),s("img",{staticClass:"menu-head-img-close",style:{display:e.groupClick?"none":"inline-block"},attrs:{src:"image/互动白底.png"}}),s("p",{staticClass:"menu-title"},[e._v("群组")]),s("img",{staticClass:"menu-arrow-open",style:{display:e.groupClick?"inline-block":"none"},attrs:{src:"image/下拉箭头.png"}}),s("img",{staticClass:"menu-arrow-close",style:{display:e.groupClick?"none":"inline-block"},attrs:{src:"image/向右箭头.png"}})]),s("ul",{staticClass:"menu-list",style:{display:e.groupClick?"block":"none"}},[s("li",[s("router-link",{attrs:{to:"/group/block"}},[e._v("我加入的群组")])],1)])]),s("div",{staticClass:"setting-menu",on:{click:e.sClick}},[s("div",{staticClass:"menu-head",style:{backgroundColor:e.settingClick?"#FE8333":"#fff"}},[s("img",{staticClass:"menu-head-img-open",style:{display:e.settingClick?"inline-block":"none"},attrs:{src:"image/设置.png"}}),s("img",{staticClass:"menu-head-img-close",style:{display:e.settingClick?"none":"inline-block"},attrs:{src:"image/设置白底.png"}}),s("p",{staticClass:"menu-title"},[e._v("设置中心")]),s("img",{staticClass:"menu-arrow-open",style:{display:e.settingClick?"inline-block":"none"},attrs:{src:"image/下拉箭头.png"}}),s("img",{staticClass:"menu-arrow-close",style:{display:e.settingClick?"none":"inline-block"},attrs:{src:"image/向右箭头.png"}})]),s("ul",{staticClass:"menu-list",style:{display:e.settingClick?"block":"none"}},[s("li",[s("router-link",{attrs:{to:"/group/setting"}},[e._v("个人信息")])],1),s("li",[s("a",{attrs:{href:"#"},on:{click:e.reLogin}},[e._v("退出")])])])])]),s("keep-alive",[s("router-view")],1)],1)])},D=[],C=(s("b0c0"),s("3410"),{name:"Group",data:function(){return{groupClick:!1,settingClick:!1}},computed:Object(o["a"])({},Object(n["e"])("group",["host"])),methods:Object(o["a"])(Object(o["a"])({},Object(n["b"])("group",["disconnect","destroyMsg","destroyHost"])),{},{gClick:function(){this.groupClick=!this.groupClick},sClick:function(){this.settingClick=!this.settingClick},reLogin:function(){localStorage.clear(),this.offLine()},offLine:function(){var e=this;this.$axios.get("http://localhost:8080/offLine",{params:{userID:this.host.userID}}).then((function(t){e.$router.replace({name:"login"})})).catch((function(e){alert("网络错误\n"+e.message)}))},beforeUpdate:function(){console.log("GroupBeforeUpdate")},updated:function(){console.log("GroupUpdated")}}),beforeRouteLeave:function(e,t,s){"login"===e.name&&(Object.getPrototypeOf(Xe).$axios.get("http://localhost:8080/offLine",{params:{userID:Xe.$store.state.group.host.userID}}),Object.getPrototypeOf(Xe).$bus.$emit("destroySetting"),Xe.$store.state.group.host={},Xe.$store.dispatch("group/destroyMsg"),localStorage.clear()),s()},beforeRouteEnter:function(e,t,s){
//!vue出现在vue程序完全从头开始构建组件时，此时还没vue实例
if(Xe)return Xe.$store.state.group.host.userID?void s():(alert("你还没有登录"),void Xe.$router.replace({name:"login"}))}}),O=C,_=(s("a99a"),Object(u["a"])(O,N,D,!1,null,null,null)),S=_.exports,k=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"b"},[s("div",{staticStyle:{height:"50px","line-height":"50px"}},[s("h1",{staticClass:"ti"},[e._v("我加入的群组")]),s("p",{staticClass:"join-total"},[e._v(e._s(e.groups.length))])]),s("hr"),""!=e.msg?s("h1",{staticClass:"msg"},[e._v(e._s(e.msg))]):e._e(),e._l(e.groups,(function(t){return s("div",{key:t.groupID,staticClass:"g"},[s("router-link",{attrs:{to:{name:"native",query:{groupID:t.groupID,leaderID:t.leaderID,groupName:t.groupName,headImageAddress:t.headImageAddress}}}},[s("img",{attrs:{src:t.headImageAddress}})]),s("router-link",{attrs:{to:{name:"native",query:{groupID:t.groupID,leaderID:t.leaderID,groupName:t.groupName,headImageAddress:t.headImageAddress}}}},[s("h1",[e._v(e._s(t.groupName))])])],1)}))],2)},$=[],j={name:"Block",data:function(){return{msg:"",init:!1}},methods:Object(o["a"])({},Object(n["b"])("group",["initGroups"])),computed:Object(o["a"])({},Object(n["e"])("group",["groups","host","users"])),activated:function(){var e=this;this.init||this.$axios.get("http://localhost:8080/list/group",{params:{userID:this.host.userID}}).then((function(t){t.data?e.initGroups(t.data):e.msg="你没有加入任何群组",e.init=!0})).catch((function(t){e.msg="请求出现异常,请检查网络环境"}))}},M=j,A=(s("c4e0"),Object(u["a"])(M,k,$,!1,null,"36376cfb",null)),E=A.exports,T=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("Nav"),s("Body")],1)},P=[],L=s("b85c"),B=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"nav"}},[s("ul",{ref:"ul",attrs:{id:"funcWindow"}},[s("li",{ref:"owner",attrs:{id:"imageAndUserName"}},[s("img",{attrs:{src:e.host.headImageAddress}}),s("span",{attrs:{id:"userName"}},[e._v(e._s(e.host.userName)+"@"+e._s(e.host.userID))])]),e._l(e.items,(function(t,a){return s("li",{key:a,ref:"items",refInFor:!0},[e._v(" "+e._s(t)+" ")])}))],2)])},H=[],R=(s("159b"),{name:"Nav",data:function(){return{items:["微信","QQ","搜索班群","客服"]}},methods:{setPadding:function(){var e=[],t=this.$refs.owner,s=this.$refs.items,a=this.$refs.ul;e.push(t),s.forEach((function(t){e.push(t)}));for(var r,i=a.clientWidth,o=0,n=0;n<e.length;n++)o+=e[n].clientWidth;r=i-o-5,r/=2*e.length;for(var l=0;l<e.length;l++){var c=parseInt(e[l].style.paddingLeft.substring(0,e[l].style.paddingLeft.length-2)),u=parseInt(e[l].style.paddingRight.substring(0,e[l].style.paddingRight.length-2));e[l].style.paddingLeft=c+r+"px",e[l].style.paddingRight=u+r+"px"}}},computed:Object(o["a"])({},Object(n["e"])("group",["host"])),mounted:function(){var e=[],t=this.$refs.owner,s=this.$refs.items;this.$refs.ul;e.push(t),s.forEach((function(t){e.push(t)}));for(var a=0;a<e.length;a++)e[a].style.paddingLeft="0px",e[a].style.paddingRight="0px";this.setPadding(),window.addEventListener("resize",this.setPadding)},beforeDestroy:function(){window.removeEventListener("resize",this.setPadding)}}),W=R,J=(s("5b49"),Object(u["a"])(W,B,H,!1,null,null,null)),G=J.exports,q=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"app"}},[s("User"),s("PrivateChatBox"),s("PublicChatBox")],1)},F=[],Y=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"user"}},[s("ul",{attrs:{id:"userList"}},e._l(e.users,(function(t){return s("li",{key:t.userID,class:{newMsg:e.isNewMsgUser(e.full(t))},on:{click:function(s){e.sendApply(s,e.wrap(e.full(t)),e.full(t))}}},[s("img",{attrs:{src:t.headImageAddress}}),s("em",[e._v(e._s(t.userName))]),s("div",{staticClass:"mask"},[s("i",{staticClass:"isAlive",class:{alive:e.isAlive(e.full(t)),offline:!e.isAlive(e.full(t))}},[e._v(" ")])]),s("i",{directives:[{name:"show",rawName:"v-show",value:e.isApply(e.full(t)),expression:"isApply(full(user))"}],staticClass:"isApply",attrs:{"data-user":e.full(t)},on:{click:function(s){e.sendAgree(e.wrap2(e.full(t)))}}},[e._v("  ")])])})),0)])},z=[],Q={name:"User",data:function(){return{color:"red"}},computed:Object(o["a"])(Object(o["a"])({},Object(n["e"])("group",["users","aliveUsers","applyUsers","agreeUsers","newMsgUsers"])),Object(n["c"])("group",["fullName"])),methods:{full:function(e){return e.userName+"@"+e.userID},isNewMsgUser:function(e){return-1!==this.newMsgUsers.indexOf(e)},isAlive:function(e){return-1!==this.aliveUsers.indexOf(e)},isApply:function(e){return-1!==this.applyUsers.indexOf(e)},wrap:function(e){if(-1===this.agreeUsers.indexOf(e)&&-1!==this.aliveUsers.indexOf(e)){var t={type:"/complex/applyConnect",text:'{"sourceUserName": "'+this.fullName+'", "targetUserName": "'+e+'"}'};return t}},wrap2:function(e){var t={type:"/complex/agreeConnect",text:'{"sourceUserName": "'+this.fullName+'", "targetUserName": "'+e+'"}'};return t},sendApply:function(e,t,s){"isApply"!==e.target.className&&-1===this.agreeUsers.indexOf(s)&&-1!==this.aliveUsers.indexOf(s)&&this.$store.dispatch("group/sendApply",t)},sendAgree:function(e){this.$store.dispatch("group/sendAgree",e)}}},K=Q,V=(s("9d95"),Object(u["a"])(K,Y,z,!1,null,"65183a18",null)),X=V.exports,Z=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"privateChatBox"}},[s("div",{attrs:{id:"chatBox"}},[s("ShowBox"),s("UserChooseBox"),s("EditBox")],1)])},ee=[],te=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{ref:"showBox",attrs:{id:"showBox"},on:{scroll:e.scrollHandler}},[s("h1",{directives:[{name:"show",rawName:"v-show",value:0===e.totalUsers.length,expression:"totalUsers.length === 0"}]},[e._v("聊天室")]),s("table",{directives:[{name:"show",rawName:"v-show",value:0===e.totalUsers.length,expression:"totalUsers.length === 0"}],attrs:{id:"defaultShowBox"}},e._l(5,(function(t){return s("tr",{key:t},e._l(5,(function(e){return s("td",{key:e})})),0)})),0),e._l(e.totalUsers,(function(t,a){return s("div",{directives:[{name:"show",rawName:"v-show",value:a===e.selected,expression:"index === selected"}],key:t},[s("div",{directives:[{name:"show",rawName:"v-show",value:-1==e.noMsg.indexOf(t)&&e.isTop(),expression:"noMsg.indexOf(totalUser) == -1 && isTop()"}],staticClass:"download"},[s("div",{staticClass:"point"}),s("div",{staticClass:"point"}),s("div",{staticClass:"point"}),s("div",{staticClass:"point"}),s("div",{staticClass:"point"}),s("div",{staticClass:"point"}),s("div",{staticClass:"point"}),s("div",{staticClass:"point"})]),e._l(e.privateMsg[t],(function(a,r){return s("div",{key:r,ref:t,refInFor:!0,class:{oppositeUser:a.sourceID!==e.host.userID,user:a.sourceID===e.host.userID}},[a.sourceID!==e.host.userID?[s("img",{staticClass:"oppositeUserImage",attrs:{src:a.headImageAddress}}),s("span",{staticClass:"oppositeUserName"},[e._v(e._s(a.userNameWithoutId))]),s("br"),s("div",{staticClass:"widthLimit"},[s("i",{staticClass:"triangle"}),s("p",{staticClass:"oppositeUserMessage"},[e._v(" "+e._s(a.message)+" ")])])]:[s("div",{ref:"bind",refInFor:!0,staticClass:"bind"},[s("span",{staticClass:"userName"},[e._v(e._s(a.userNameWithoutId))]),s("img",{staticClass:"userImage",attrs:{src:a.headImageAddress}})]),s("br"),s("div",{ref:"widthLimit",refInFor:!0,staticClass:"widthLimit"},[s("p",{ref:"userMessage",refInFor:!0,staticClass:"userMessage"},[e._v(" "+e._s(a.message)+" ")]),s("i",{staticClass:"triangle"})])]],2)}))],2)}))],2)},se=[],ae={name:"ShowBox",data:function(){return{firstScroll:[],noMsg:[]}},computed:Object(o["a"])(Object(o["a"])({},Object(n["e"])("group",["agreeUsers","privateMsg","selected","host","room","users"])),Object(n["c"])("group",["totalUsers","fullName"])),methods:Object(o["a"])(Object(o["a"])({},Object(n["d"])("group",["updatePrivateMsgBefore"])),{},{isTop:function(){return 0===this.$refs.showBox.scrollTop&&this.$refs.showBox.scrollHeight!==this.$refs.showBox.clientHeight},style:function(e,t,s){var a=e.offsetWidth+36;a<t.clientWidth?e.style.left=t.clientWidth-a+"px":e.style.width=t.clientWidth-36-20+"px",s.style.left="calc(100% - "+s.clientWidth+"px)"},scrollHandler:function(){this.$refs.showBox;this.isTop()&&-1===this.noMsg.indexOf(this.totalUsers[this.selectedUser])&&this.getData()},getData:function(){var e=this,t=this.totalUsers[this.selected],s=t.substring(t.lastIndexOf("@")+1),a=t.substring(0,t.lastIndexOf("@"));this.$axios.get("http://localhost:8080/list/record",{params:{groupID:this.room.groupID,userID:this.host.userID,oppositeID:s,time:this.privateMsg[t][0].time}}).then((function(r){if(r.data&&r.data.length){var i,o=Object(L["a"])(r.data);try{for(o.s();!(i=o.n()).done;){var n=i.value;n.userNameWithoutId=n.sourceID===s?a:e.host.userName,n.headImageAddress=n.sourceID===s?e.users.filter((function(e){return e.userID===s}))[0].headImageAddress:e.host.headImageAddress,n.sourceName=n.userNameWithoutId+"@"+n.sourceID,n.targetName=(n.targetID===s?a:e.host.userName)+"@"+n.targetID,e.updatePrivateMsgBefore(n)}}catch(l){o.e(l)}finally{o.f()}}else e.noMsg.push(t)}))},wholeStyle:function(){if(-1===this.firstScroll.indexOf(this.totalUsers[this.selected])){this.firstScroll.push(this.totalUsers[this.selected]);var e=this.$refs[this.totalUsers[this.selected]];if(e)for(var t=e.length-1;t>=0;t--){var s=e[t];if("oppositeUser"!==s.className){var a=s.querySelector(".bind"),r=s.querySelector(".widthLimit"),i=r.querySelector(".userMessage");this.style(i,r,a)}}}}}),beforeUpdate:function(){var e=this,t=this.$refs.showBox;t.scrollHeight-t.clientHeight-t.scrollTop<5&&this.$nextTick((function(){t.scrollTop=t.scrollHeight-t.clientHeight,0!==t.scrollTop&&e.wholeStyle()}))},updated:function(){var e=this.$refs[this.totalUsers[this.selected]];if(e)for(var t=e.length-1;t>=0;t--){var s=e[t];if("oppositeUser"!==s.className){if(s.querySelector(".bind").style.left)break;var a=s.querySelector(".bind"),r=s.querySelector(".widthLimit"),i=r.querySelector(".userMessage");this.style(i,r,a)}}}},re=ae,ie=(s("4899"),Object(u["a"])(re,te,se,!1,null,null,null)),oe=ie.exports,ne=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"userChooseBox"}},[e._l(e.totalUsers,(function(t,a){return s("button",{key:t,staticClass:"user",class:{selected:e.selected===a,offline:a>e.agreeUsers.length-1},on:{click:function(t){return e.clickSelected(a)}}},[e._v(" "+e._s(t.substring(0,t.lastIndexOf("@")))+" ")])})),s("span",{ref:"laba",staticClass:"laba",on:{click:e.changeMode}},[e._v("")])],2)},le=[],ce={name:"UserChooseBox",data:function(){return{public:!1}},computed:Object(o["a"])(Object(o["a"])({},Object(n["e"])("group",["agreeUsers","aliveUsers","newMsgUsers","selected"])),Object(n["c"])("group",["totalUsers"])),methods:Object(o["a"])(Object(o["a"])(Object(o["a"])({},Object(n["b"])("group",["updateSelected"])),Object(n["d"])("group",["updateNewMsgUsers"])),{},{clickSelected:function(e){var t=this.totalUsers[e],s=this.newMsgUsers.filter((function(e){return e!==t}));this.updateSelected(e),this.updateNewMsgUsers(s)},changeMode:function(){this.public=!this.public;var e="",t="";this.public?(this.$refs.laba.innerText="",e="#0b0c10",t="#fff000"):(this.$refs.laba.innerText="",e="#fff",t="#000"),this.$bus.$emit("choosePublic",this.public),this.$bus.$emit("chooseColor",t),this.$bus.$emit("chooseBackGroundColor",e)}})},ue=ce,de=(s("6f34"),Object(u["a"])(ue,ne,le,!1,null,null,null)),pe=de.exports,he=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"editBox"}},[s("textarea",{directives:[{name:"model",rawName:"v-model",value:e.msg,expression:"msg"}],style:{color:e.color,backgroundColor:e.backgroundColor},domProps:{value:e.msg},on:{input:function(t){t.target.composing||(e.msg=t.target.value)}}}),e._v(" "),s("button",{style:{color:e.color},attrs:{id:"close"}},[e._v("关闭")]),s("button",{style:e.color,attrs:{id:"send",disabled:e.isDisabled()},on:{click:e.send}},[e._v(" 发送 ")])])},ge=[],me={name:"EditBox",data:function(){return{msg:"",public:!1,color:"#000",backgroundColor:"#fff"}},computed:Object(o["a"])(Object(o["a"])({},Object(n["e"])("group",["host","room","agreeUsers","selected"])),Object(n["c"])("group",["fullName"])),methods:Object(o["a"])(Object(o["a"])({},Object(n["b"])("group",["sendPrivate","sendPublic"])),{},{isDisabled:function(){return(!this.agreeUsers.length||this.selected>this.agreeUsers.length-1)&&!this.public},send:function(){this.public?this.sendPublic(this.wrap2()):this.sendPrivate(this.wrap())},wrap:function(){var e={type:"/complex/sendMessageToUser",text:'{"groupID": "'+this.room.groupID+'", "sourceID": "'+this.host.userID+'", "targetID": "'+this.agreeUsers[this.selected].substring(this.agreeUsers[this.selected].lastIndexOf("@")+1)+'", "time": "'+Date.now()+'", "message": "'+this.msg+'" ,"targetName": "'+this.agreeUsers[this.selected]+'", "sourceName": "'+this.fullName+'", "userNameWithoutId": "'+this.host.userName+'", "headImageAddress": "'+this.host.headImageAddress+'"}'};return e},wrap2:function(){var e={type:"/simple/greeting",text:'{"userName": "'+this.fullName+'","content": "'+this.msg+'"}'};return e},clickBtn:function(){this.public?this.sendPublic(this.wrap2()):this.sendPrivate(this.wrap())}}),mounted:function(){var e=this;this.$bus.$on("choosePublic",(function(t){e.public=t})),this.$bus.$on("chooseColor",(function(t){e.color=t})),this.$bus.$on("chooseBackGroundColor",(function(t){e.backgroundColor=t}))}},fe=me,ve=(s("e2b7"),Object(u["a"])(fe,he,ge,!1,null,"12561b9f",null)),be=ve.exports,ye={name:"PrivateChatBox",components:{ShowBox:oe,UserChooseBox:pe,EditBox:be}},Ie=ye,we=(s("4547"),Object(u["a"])(Ie,Z,ee,!1,null,null,null)),xe=we.exports,Ue=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"publicChatBox"}},[e._m(0),s("div",{ref:"showBox",attrs:{id:"p_showBox"}},e._l(e.msgList,(function(t,a){return s("p",{key:a},[s("span",{staticStyle:{color:"red"}},[e._v(e._s(t.userName+" "))]),s("span",[e._v(e._s(t.content))])])})),0),s("div",{attrs:{id:"extraTool"}},[e._v("额外带扩展窗口")])])},Ne=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"laba"}},[s("div",{attrs:{id:"signal"}},[e._v("喇叭")])])}],De={name:"PublicChatBox",data:function(){return{focus:!1}},computed:Object(o["a"])({},Object(n["e"])("group",["msgList"])),methods:{},beforeUpdate:function(){var e=this.$refs.showBox;e.scrollHeight-e.clientHeight-e.scrollTop<5&&this.$nextTick((function(){e.scrollTop=e.scrollHeight-e.clientHeight}))}},Ce=De,Oe=(s("b10a"),Object(u["a"])(Ce,Ue,Ne,!1,null,null,null)),_e=Oe.exports,Se={name:"Body",components:{User:X,PrivateChatBox:xe,PublicChatBox:_e}},ke=Se,$e=(s("ed04"),Object(u["a"])(ke,q,F,!1,null,null,null)),je=$e.exports,Me={name:"Native",components:{Nav:G,Body:je},props:["groupID","leaderID","groupName","headImageAddress"],computed:Object(o["a"])({},Object(n["e"])("group",["host","room","users"])),methods:Object(o["a"])(Object(o["a"])({},Object(n["b"])("group",["initUsers","initRoom","connect","disconnect","destroyData","destroyMsg"])),Object(n["d"])("group",["updatePrivateMsg"])),activated:function(){var e=this,t=!1;this.room.groupID!==this.groupID&&(this.destroyMsg(),t=!0),this.$axios.get("http://localhost:8080/list/user",{params:{userID:this.host.userID,groupID:this.groupID}}).then((function(s){if(s.data){if(e.destroyData(),e.initRoom({groupID:e.groupID,leaderID:e.leaderID,groupName:e.groupName,headImageAddress:e.headImageAddress}),e.initUsers(s.data),t){var a,r=Object(L["a"])(e.users);try{var i=function(){var t=a.value;e.$axios.get("http://localhost:8080/list/record",{params:{groupID:e.room.groupID,userID:e.host.userID,oppositeID:t.userID,time:Date.now()}}).then((function(s){if(s.data&&s.data.length)for(var a=s.data.length-1;a>=0;a--){var r=s.data[a];r.userNameWithoutId=r.sourceID==t.userID?t.userName:e.host.userName,r.headImageAddress=r.sourceID==t.userID?t.headImageAddress:e.host.headImageAddress,r.sourceName=r.userNameWithoutId+"@"+r.sourceID,r.targetName=(r.targetID==t.userID?t.userName:e.host.userName)+"@"+r.targetID,e.updatePrivateMsg(r)}else;}))};for(r.s();!(a=r.n()).done;)i()}catch(o){r.e(o)}finally{r.f()}}e.connect()}else alert("获取群组列表失败"),e.$router.replace({name:"group"})})).catch((function(t){e.error="请求发生异常，请检查网络环境",e.$router.replace({name:"group"})}))},deactivated:function(){this.destroyData(),this.disconnect()},beforeRouteEnter:function(e,t,s){if(Xe)return Xe.$store.state.group.host.userID?Xe.$store.state.group.host.userName?void s():(alert("你还没有设置昵称"),void Xe.$router.replace({name:"group"})):(alert("你还没有登录"),void Xe.$router.replace({name:"login"}))}},Ae=Me,Ee=Object(u["a"])(Ae,T,P,!1,null,null,null),Te=Ee.exports,Pe=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"setting"},[s("ul",[s("li",[s("img",{attrs:{id:"head",src:e.host.headImageAddress}}),s("div",{attrs:{id:"persion"}},[s("span",{attrs:{id:"name"}},[e._v(e._s(e.host.userName))]),s("br"),s("span",{attrs:{id:"userID"}},[e._v(e._s(e.host.userID))])]),s("i",{staticClass:"rectangle",on:{click:function(t){e.showUpdateList=!e.showUpdateList}}}),s("i",{staticClass:"rectangle",on:{click:function(t){e.showUpdateList=!e.showUpdateList}}}),s("i",{staticClass:"rectangle",on:{click:function(t){e.showUpdateList=!e.showUpdateList}}}),s("ul",{directives:[{name:"show",rawName:"v-show",value:e.showUpdateList,expression:"showUpdateList"}],attrs:{id:"updateList"}},[s("li",{on:{click:function(t){e.showUpdateHeadImage=!0,e.showUpdateUserName=!1}}},[e._v(" 更改头像 ")]),s("li",{on:{click:function(t){e.showUpdateUserName=!0,e.showUpdateHeadImage=!1}}},[e._v(" 更改昵称 ")])]),s("div",{directives:[{name:"show",rawName:"v-show",value:e.showUpdateHeadImage,expression:"showUpdateHeadImage"}],attrs:{id:"updateHeadImage"}},[s("div",{staticClass:"tip"},[e._v("选择一张图片")]),s("div",{staticClass:"upload"},[s("input",{ref:"photo",attrs:{type:"file"}}),s("button",{attrs:{type:"button"},on:{click:e.uploadHeadImage}},[e._v("上传")])]),s("div",{staticClass:"close",on:{click:function(t){e.showUpdateHeadImage=!1}}},[s("i",{staticClass:"leftLine"}),s("i",{staticClass:"rightLine"})])]),s("div",{directives:[{name:"show",rawName:"v-show",value:e.showUpdateUserName,expression:"showUpdateUserName"}],attrs:{id:"updateUserName"}},[s("div",{staticClass:"tip"},[e._v("修改昵称")]),s("div",{staticClass:"upload"},[e._v(" 编辑昵称 "),s("input",{ref:"userName",attrs:{type:"text",placeholder:"昵称"}}),s("button",{attrs:{type:"button"},on:{click:e.uploadUserName}},[e._v("更新")])]),s("div",{staticClass:"close",on:{click:function(t){e.showUpdateUserName=!1}}},[s("i",{staticClass:"leftLine"}),s("i",{staticClass:"rightLine"})])])]),s("li",[s("span",[e._v("")]),s("span",{class:{noMsg:!e.host.detail.sex}},[e._v(e._s(e.host.detail.sex?e.host.detail.sex:"性别"))]),s("i",{staticClass:"line"}),s("span",{class:{noMsg:!e.host.detail.age}},[e._v(e._s(e.host.detail.age?e.host.detail.age:"年龄"))]),s("i",{staticClass:"line"}),s("span",{class:{noMsg:!e.host.detail.birthday}},[e._v(e._s(e.host.detail.birthday?e.getBirthday(e.host.detail.birthday):"出生日期"))]),s("i",{staticClass:"line"}),s("span",{class:{noMsg:!e.host.detail.location}},[e._v(e._s(e.host.detail.location?e.host.detail.location:"居住地址"))]),s("i",{staticClass:"triangle",on:{click:e.skipToEdit}})]),s("li",[s("span",[e._v("")]),s("span",{class:{noMsg:!e.host.detail.persionalSign}},[e._v(e._s(e.host.detail.persionalSign?e.host.detail.persionalSign:"个性签名"))]),s("i",{staticClass:"triangle",on:{click:e.skipToEdit}})]),s("li",[s("span",[e._v("xx")]),s("i",{staticClass:"triangle",on:{click:e.skipToEdit}})]),s("li",[s("span",[e._v("xx")]),s("i",{staticClass:"triangle",on:{click:e.skipToEdit}})])])])},Le=[],Be=(s("498a"),{name:"Setting",data:function(){return{showUpdateList:!1,showUpdateHeadImage:!1,showUpdateUserName:!1}},computed:Object(o["a"])({},Object(n["e"])("group",["host"])),methods:Object(o["a"])(Object(o["a"])({},Object(n["d"])("group",["updateHeadImage","updateUserName"])),{},{skipToEdit:function(){this.$router.replace({name:"edit"})},getBirthday:function(e){console.log(e);var t=new Date(e);return t.getFullYear()+"年"+(t.getMonth()+1)+"月"+(t.getDay()+1)+"日"},uploadHeadImage:function(){var e=this,t=new FormData;if(this.$refs.photo.files[0]){var s=this.$refs.photo.files[0];if(s.size>1048576)alert("上传的图片大于1M");else{var a,r=s.name.lastIndexOf(".");a=-1==r?"":s.name.substring(r+1);var i=this.host.userID+(""===a?"":"."+a);t.append(i,s),this.$axios.post("http://localhost/upload/headImage",t).then((function(t){200!==t.status?alert("上传头像失败"):e.$axios.get("http://localhost:8080/update/headImage",{params:{userID:e.host.userID,headImageAddress:"image/"+i}}).then((function(t){!1===t?alert("更新头像失败"):(alert("更新头像成功"),e.updateHeadImage("image/"+i),e.showUpdateList=!1,e.showUpdateHeadImage=!1,e.showUpdateUserName=!1)})).catch((function(e){alert("网络错误"+e.message)}))})).catch((function(e){alert("网络错误"+e.message)}))}}else alert("没有选择要上传得头像图片")},uploadUserName:function(){var e=this,t=this.$refs.userName.value.trim();""!==t?this.$axios.get("http://localhost:8080/update/userName",{params:{userID:this.host.userID,userName:t}}).then((function(s){!1===s.data?alert("更新昵称失败"):(alert("更新昵称成功"),e.updateUserName(t),e.showUpdateList=!1,e.showUpdateHeadImage=!1,e.showUpdateUserName=!1)})).catch((function(e){alert("网络错误"+e.message)})):alert("昵称为空")}}),mounted:function(){var e=this;this.$bus.$on("destroySetting",(function(){e.$destroy()}))},beforeDestroy:function(){console.log("setting要销毁了"),this.$bus.$off("destroySetting")}}),He=Be,Re=(s("2153"),Object(u["a"])(He,Pe,Le,!1,null,"df33f79c",null)),We=Re.exports,Je=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"edit"},[s("div",{attrs:{id:"head"}},[s("div",{staticClass:"triangle",on:{click:e.skipToSetting}}),e._v(" 详细资料 ")]),s("ul",[s("li",[e._v(" 性别"),s("input",{directives:[{name:"model",rawName:"v-model",value:e.sex,expression:"sex"}],attrs:{type:"text",placeholder:"编辑你的性别"},domProps:{value:e.sex},on:{input:function(t){t.target.composing||(e.sex=t.target.value)}}})]),s("hr"),s("li",[e._v(" 年龄"),s("input",{directives:[{name:"model",rawName:"v-model",value:e.age,expression:"age"}],attrs:{type:"text",placeholder:"编辑你的年龄"},domProps:{value:e.age},on:{input:function(t){t.target.composing||(e.age=t.target.value)}}})]),s("hr"),s("li",[e._v(" 生日"),s("input",{directives:[{name:"model",rawName:"v-model",value:e.birthday,expression:"birthday"}],attrs:{type:"date",placeholder:"编辑你的生日"},domProps:{value:e.birthday},on:{input:function(t){t.target.composing||(e.birthday=t.target.value)}}})]),s("hr"),s("li",[e._v(" 用户地址"),s("input",{directives:[{name:"model",rawName:"v-model",value:e.location,expression:"location"}],attrs:{type:"text",placeholder:"编辑你的地址"},domProps:{value:e.location},on:{input:function(t){t.target.composing||(e.location=t.target.value)}}})]),s("hr"),s("li",[e._v(" 个性签名"),s("input",{directives:[{name:"model",rawName:"v-model",value:e.persionalSign,expression:"persionalSign"}],attrs:{type:"text",placeholder:"编辑你的个性签名"},domProps:{value:e.persionalSign},on:{input:function(t){t.target.composing||(e.persionalSign=t.target.value)}}})])]),s("button",{attrs:{id:"editBtn",type:"button"},on:{click:e.modifyDetail}},[e._v("修改资料")])])},Ge=[],qe=s("ade3"),Fe=Object(qe["a"])({name:"Edit",data:function(){return{sex:"",age:"",birthday:"",location:"",persionalSign:""}},updated:function(){console.log(this.birthday)},computed:Object(o["a"])({},Object(n["e"])("group",["host"])),methods:Object(o["a"])(Object(o["a"])({},Object(n["d"])("group",["updateDetail"])),{},{skipToSetting:function(){this.$router.replace({name:"setting"})},modifyDetail:function(){var e=this;this.sex!==this.host.detail.sex||this.age!==this.host.detail.age||this.birthday&&new Date(this.birthday).getTime()!==this.host.detail.birthday||this.location!==this.host.detail.location||this.persionalSign!==this.host.detail.persionalSign?this.sex.length>1||"男"!==this.sex&&"女"!==this.sex?alert("性别只能为男或女"):this.age.length>3||0!==this.age.split("").filter((function(e){return!(e>="0"&&e<="9")})).length?alert("年龄只能是0~999"):this.location.length>100?alert("居住地址的长度不能超过100"):this.persionalSign.length>100?alert("个性签名的长度不能超过100"):this.$axios.get("http://localhost:8080/detail/put",{params:{userID:this.host.userID,sex:this.sex,age:this.age,birthday:new Date(this.birthday).getTime(),location:this.location,persionalSign:this.persionalSign}}).then((function(t){!0!==t.data?alert("更新失败\n"+t.message):(alert("更新成功"),console.log("前"),e.updateDetail({sex:e.sex,age:e.age,birthday:e.birthday?new Date(e.birthday).getTime():null,location:e.location,persionalSign:e.persionalSign}),console.log("后"))})).catch((function(e){alert("网络错误\n"+e.message)})):alert("你没有更改任何信息")}}),activated:function(){console.log("settingactived");var e=new Date(this.host.detail.birthday);this.sex=this.host.detail.sex,this.age=this.host.detail.age,this.birthday=e.getFullYear()+"-"+(e.getMonth()+1<=9?"0"+(e.getMonth()+1):e.getMonth()+1)+"-"+(e.getDay()+1<=9?"0"+(e.getDay()+1):e.getDay()+1),this.location=this.host.detail.location,this.persionalSign=this.host.detail.persionalSign},beforeUpdate:function(){console.log("editBeforeUpdate")}},"updated",(function(){console.log("editUpdated")})),Ye=Fe,ze=(s("cffc"),Object(u["a"])(Ye,Je,Ge,!1,null,"4c0b3b2f",null)),Qe=ze.exports;a["a"].use(v["a"]);var Ke=new v["a"]({routes:[{name:"login",path:"/login",component:U},{name:"native",path:"/native",component:Te,props:function(e){return{groupID:e.query.groupID,leaderID:e.query.leaderID,groupName:e.query.groupName,headImageAddress:e.query.headImageAddress}},beforeEnter:function(e,t,s){localStorage.getItem("login")&&"true"===localStorage.getItem("login")?s():alert("请先登录")}},{name:"group",path:"/group",component:S,children:[{name:"block",path:"block",component:E},{name:"setting",path:"setting",component:We},{name:"edit",path:"edit",component:Qe}],beforeEnter:function(e,t,s){localStorage.getItem("login")&&"true"===localStorage.getItem("login")?s():alert("请先登录")}}]}),Ve=Ke;a["a"].config.productionTip=!1,f.a.defaults.withCredentials=!0;var Xe=t["default"]=new a["a"]({el:"#app",store:g,render:function(e){return e(p)},router:Ve,beforeCreate:function(){a["a"].prototype.$bus=this,a["a"].prototype.$axios=f.a}})},"58de":function(e,t,s){},"5b49":function(e,t,s){"use strict";s("58de")},"6e32":function(e,t,s){},"6f34":function(e,t,s){"use strict";s("9d09")},"85ec":function(e,t,s){},"9c5e":function(e,t,s){},"9d09":function(e,t,s){},"9d95":function(e,t,s){"use strict";s("9c5e")},a99a:function(e,t,s){"use strict";s("cbf4")},b10a:function(e,t,s){"use strict";s("6e32")},b1ab:function(e,t,s){},c4e0:function(e,t,s){"use strict";s("3fd0")},cbf4:function(e,t,s){},cffc:function(e,t,s){"use strict";s("2583")},db6a:function(e,t,s){},e2b7:function(e,t,s){"use strict";s("fea3")},e943:function(e,t,s){},ed04:function(e,t,s){"use strict";s("db6a")},f0ee:function(e,t,s){},fea3:function(e,t,s){}});
//# sourceMappingURL=index.6ee9f984.js.map